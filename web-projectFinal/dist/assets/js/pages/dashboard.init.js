var pollingData,fivethirtyeightData,myInit={method:"GET",headers:{"Content-Type":"application/json"},mode:"cors",cache:"default"};function CreateTableFromJSON(){for(var t=[{"Book ID":"1","Book Name":"Computer Architecture",Category:"Computers",Price:"125.60"},{"Book ID":"2","Book Name":"Asp.Net 4 Blue Book",Category:"Programming",Price:"56.00"},{"Book ID":"3","Book Name":"Popular Science",Category:"Science",Price:"210.40"}],e=[],r=0;r<t.length;r++)for(var o in t[r])-1===e.indexOf(o)&&e.push(o);for(var n=document.createElement("table"),a=n.insertRow(-1),r=0;r<e.length;r++){var i=document.createElement("th");i.innerHTML=e[r],a.appendChild(i)}for(r=0;r<t.length;r++){a=n.insertRow(-1);for(var c=0;c<e.length;c++)a.insertCell(-1).innerHTML=t[r][e[c]]}var u=document.getElementById("showData");u.innerHTML="",u.appendChild(n)}function createWordCloud(t,e){t=anychart.tagCloud(t);t.title("15 most spoken languages"),t.angles([0]),t.colorRange(!1),t.colorRange().length("80%"),t.container("topic"+e),t.draw()}function createChart(t,e,r,o){o={chart:{height:350,type:"line",zoom:{enabled:!0},toolbar:{show:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:3},series:[{name:"Tweet Sentiment",data:e},{name:"Five Thirty Eight",data:r}],colors:["#5664d2","#1cbb8c"],xaxis:{type:"datetime",categories:o},yaxis:{title:{text:"sentiment"},min:0,max:100},grid:{borderColor:"#f1f1f1",padding:{bottom:15}},tooltip:{x:{format:"dd/MM/yy HH:mm"}},legend:{offsetY:7}};new ApexCharts(document.querySelector("#"+t),o).render()}a="",fetch("https://projects.fivethirtyeight.com/polls/president-general/national/polling-average.json").then(function(t){return t.ok?t.json():Promise.reject(t)}).then(function(t){return fivethirtyeightData=t,fetch("http://138.91.35.252/output/processed.json")}).then(function(t){return t.ok?t.json():Promise.reject(t)}).then(function(t){for(pD in totalDateArr=[],fteBidenArr=[],fteTrumpArr=[],bidenCompoundArr=[],trumpCompoundArr=[],pollingData=t){for(r in curDate=pollingData[pD].date,fivethirtyeightData)if(fivethirtyeightData[r].date==curDate)if("Joseph R. Biden Jr."==fivethirtyeightData[r].candidate)for(i=0;i<24;i++)fteBidenArr.push(Math.trunc(fivethirtyeightData[r].pct_trend_adjusted.toFixed(2)));else for(i=0;i<24;i++)fteTrumpArr.push(Math.trunc(fivethirtyeightData[r].pct_trend_adjusted.toFixed(2)));for(s in sentiments=pollingData[pD].sentiments,sentiments)try{if(curS=sentiments[s],Array.isArray(curS.biden)&&curS.biden.length||Array.isArray(curS.trump)&&curS.trump.length)continue;curS.hour<=9?totalDateArr.push(curDate+"T0"+curS.hour+":00:00"):10<=curS.hour&&totalDateArr.push(curDate+"T"+curS.hour+":00:00"),bidenCompoundArr.push(50+Math.trunc(100*curS.biden.compounded.toFixed(2))),trumpCompoundArr.push(50+Math.trunc(100*curS.trump.compounded.toFixed(2)))}catch(t){bidenCompoundArr.push(50),trumpCompoundArr.push(50)}}curTopics=pollingData[0].topics;var e=[];for(cT in curTopics){var r=curTopics[cT];for(words in r)console.log(words),console.log(r[words]),e.push({x:words,value:r[words],category:words});createWordCloud(e,1)}createChart("trumpSentimentChart",trumpCompoundArr,fteTrumpArr,totalDateArr),createChart("bidenSentimentChart",bidenCompoundArr,fteBidenArr,totalDateArr)}).catch(function(t){console.warn(t)});